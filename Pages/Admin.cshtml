@page
@model HelloWorldWeb.Pages.AdminModel
@{
    Layout = null;
}

<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="utf-8" />
    <title>ğŸ”§ ×××©×§ × ×™×”×•×œ</title>
    <link rel="stylesheet" href="/css/site.css" />
    <style>
        body {
            background-color: #111;
            color: #fff;
            font-family: "Segoe UI", sans-serif;
            padding: 40px;
            direction: rtl;
        }
        h1 {
            font-size: 32px;
            margin-bottom: 20px;
        }
        h2 {
            margin-top: 40px;
            border-bottom: 2px solid #333;
            padding-bottom: 5px;
            color: #ffd700;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 15px;
            background-color: #1e1e1e;
            border-radius: 10px;
            overflow: hidden;
        }
        th, td {
            padding: 12px;
            border-bottom: 1px solid #333;
            text-align: center;
        }
        th {
            background-color: #222;
            font-weight: bold;
        }
        tr:nth-child(even) {
            background-color: #191919;
        }
        .btn {
            padding: 6px 12px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-weight: bold;
        }
        .btn-unflag {
            background-color: #32cd32;
            color: white;
        }
        .btn-unflag:hover {
            background-color: #28a428;
        }
        .btn-ban {
            background-color: #ff4c4c;
            color: white;
        }
        .btn-ban:hover {
            background-color: #cc0000;
        }
        .btn-delete {
            background-color: #ff9900;
            color: white;
        }
        .btn-delete:hover {
            background-color: #cc7a00;
        }
        ul li {
            margin: 8px 0;
        }
        ul strong {
            color: #1e90ff;
        }
        .back-to-quiz {
            display: inline-block;
            margin-top: 30px;
            padding: 10px 20px;
            background-color: #1e90ff;
            color: white;
            text-decoration: none;
            border-radius: 8px;
            font-weight: bold;
        }
        .back-to-quiz:hover {
            background-color: #0077cc;
        }
        .background-gif {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            object-fit: cover;
            opacity: 0.05;
            z-index: -1;
        }
    </style>
</head>
<body>
    <img src="/assets/background.gif" class="background-gif" alt="×¨×§×¢" />
    <h1>ğŸ“Š ×××©×§ × ×™×”×•×œ - Dashboard</h1>

    @if (TempData["SuccessMessage"] != null)
    {
        <div style="background-color:#28a428; padding:12px; border-radius:6px; margin:20px 0; color:white; font-weight:bold; text-align:center;">
            @TempData["SuccessMessage"]
        </div>
    }

    <h2>âœ… ×¡×˜×˜×™×¡×˜×™×§×” ×›×œ×œ×™×ª</h2>
    <ul>
        <li>ğŸ‘¥ ××©×ª××©×™× ×¨×©×•××™×: <strong>@Model.AllUsers.Count</strong></li>
        <li>ğŸŸ¢ ××—×•×‘×¨×™× ×›×¨×’×¢: <strong>@Model.OnlineUsers.Count</strong></li>
        <li>ğŸš© ××¡×•×× ×™× ×›â€Cheaters: <strong>@Model.Cheaters.Count</strong></li>
        <li>ğŸ”’ ×—×¡×•××™×: <strong>@Model.BannedUsers.Count</strong></li>
        <li>ğŸ“ˆ ×××•×¦×¢ ×”×¦×œ×—×”: <strong>@Model.AverageSuccessRate.ToString("0.0")%</strong></li>
    </ul>

    <h2>ğŸ“¶ ××©×ª××©×™× ××—×•×‘×¨×™× ×›×¨×’×¢</h2>
    <table>
        <tr><th>×©× ××©×ª××©</th><th>× ×¢× ×•</th><th>× ×›×•× ×•×ª</th><th>×”×¦×œ×—×”</th></tr>
        @foreach (var user in Model.OnlineUsers)
        {
            <tr>
                <td>@user.Username</td>
                <td>@user.TotalAnswered</td>
                <td>@user.CorrectAnswers</td>
                <td>@(user.TotalAnswered > 0 ? ((double)user.CorrectAnswers / user.TotalAnswered).ToString("0%") : "N/A")</td>
            </tr>
        }
    </table>

    <h2>ğŸ† ×˜×‘×œ×ª ××•×‘×™×œ×™×</h2>
    <table>
        <tr><th>××™×§×•×</th><th>×©× ××©×ª××©</th><th>×ª×©×•×‘×•×ª × ×›×•× ×•×ª</th></tr>
        @for (int i = 0; i < Model.TopUsers.Count; i++)
        {
            <tr>
                <td>@(i + 1)</td>
                <td>@Model.TopUsers[i].Username</td>
                <td>@Model.TopUsers[i].CorrectAnswers</td>
            </tr>
        }
    </table>

    <h2>ğŸš¨ Cheaters</h2>
    <table>
        <tr><th>×©× ××©×ª××©</th><th>× ×¢× ×•</th><th>× ×›×•× ×•×ª</th><th>×”×¦×œ×—×”</th><th>×¤×¢×•×œ×•×ª</th></tr>
        @foreach (var user in Model.Cheaters)
        {
            <tr>
                <td>@user.Username</td>
                <td>@user.TotalAnswered</td>
                <td>@user.CorrectAnswers</td>
                <td>@(user.TotalAnswered > 0 ? ((double)user.CorrectAnswers / user.TotalAnswered).ToString("0%") : "N/A")</td>
                <td>
                    <form method="post" asp-page-handler="Unflag" asp-route-username="@user.Username" style="display:inline;">
                        @Html.AntiForgeryToken()
                        <button class="btn btn-unflag">×©×—×¨×¨</button>
                    </form>
                    <form method="post" asp-page-handler="Ban" asp-route-username="@user.Username" style="display:inline;">
                        @Html.AntiForgeryToken()
                        <button class="btn btn-ban">×—×¡×•×</button>
                    </form>
                    <form method="post" asp-page-handler="Delete" asp-route-username="@user.Username" style="display:inline;">
                        @Html.AntiForgeryToken()
                        <button class="btn btn-delete">ğŸ—‘ï¸ ××—×§</button>
                    </form>
                </td>
            </tr>
        }
    </table>

    <h2>ğŸ”’ ×—×¡×•××™×</h2>
    <table>
        <tr><th>×©× ××©×ª××©</th><th>× ×¢× ×•</th><th>× ×›×•× ×•×ª</th><th>×”×¦×œ×—×”</th><th>×¤×¢×•×œ×”</th></tr>
        @foreach (var user in Model.BannedUsers)
        {
            <tr>
                <td>@user.Username</td>
                <td>@user.TotalAnswered</td>
                <td>@user.CorrectAnswers</td>
                <td>@(user.TotalAnswered > 0 ? ((double)user.CorrectAnswers / user.TotalAnswered).ToString("0%") : "N/A")</td>
                <td>
                    <form method="post" asp-page-handler="Unban" asp-route-username="@user.Username">
                        @Html.AntiForgeryToken()
                        <button class="btn btn-unflag">×©×—×¨×¨</button>
                    </form>
                </td>
            </tr>
        }
    </table>

    <a href="/Index" class="back-to-quiz">â¬… ×—×–×¨×” ×œ×—×™×“×•×Ÿ</a>
</body>
</html>
